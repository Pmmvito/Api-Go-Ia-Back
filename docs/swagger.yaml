basePath: /api/v1
definitions:
  handler.AuthResponse:
    properties:
      message:
        type: string
      token:
        type: string
      user:
        $ref: '#/definitions/schemas.UserResponse'
    type: object
  handler.CreateCategoryRequest:
    properties:
      color:
        example: '#3498db'
        type: string
      description:
        example: Gastos com viagens e turismo
        type: string
      icon:
        example: ✈️
        type: string
      name:
        example: Viagens
        type: string
    required:
    - name
    type: object
  handler.ErrorResponse:
    properties:
      errorCode:
        type: string
      message:
        type: string
    type: object
  handler.ItemRecategorizationResult:
    properties:
      changed:
        type: boolean
      itemId:
        type: integer
      newCategoryId:
        type: integer
      newCategoryName:
        type: string
      oldCategoryId:
        type: integer
      oldCategoryName:
        type: string
      productName:
        type: string
    type: object
  handler.LoginRequest:
    properties:
      email:
        example: joao@example.com
        type: string
      password:
        example: senha123
        type: string
    required:
    - email
    - password
    type: object
  handler.PreviewItem:
    properties:
      deleted:
        description: Se true, o item será ignorado ao confirmar
        type: boolean
      description:
        description: Nome do produto
        type: string
      quantity:
        description: Quantidade do item
        type: number
      tempId:
        description: ID temporário para facilitar a edição no frontend
        type: integer
      total:
        description: Total do item
        type: number
      unit:
        description: Unidade de medida (kg, un, ml, etc)
        type: string
      unitPrice:
        description: Preço por unidade
        type: number
    type: object
  handler.PreviewReceiptData:
    properties:
      accessKey:
        description: Chave de acesso da NFC-e
        type: string
      date:
        description: Data da compra
        type: string
      discount:
        description: Desconto
        type: number
      items:
        description: Itens extraídos do recibo
        items:
          $ref: '#/definitions/handler.PreviewItem'
        type: array
      itemsCount:
        description: Total de itens
        type: integer
      number:
        description: Número da nota
        type: string
      qrCodeUrl:
        description: URL original do QR code para confirmação
        type: string
      storeName:
        description: Nome do estabelecimento
        type: string
      subtotal:
        description: Subtotal
        type: number
      total:
        description: Total
        type: number
    type: object
  handler.RecategorizeItemsRequest:
    properties:
      itemIds:
        description: IDs dos items a serem recategorizados
        items:
          type: integer
        type: array
    required:
    - itemIds
    type: object
  handler.RecategorizeItemsResponse:
    properties:
      itemsRecategorized:
        type: integer
      message:
        type: string
      results:
        items:
          $ref: '#/definitions/handler.ItemRecategorizationResult'
        type: array
    type: object
  handler.RegisterRequest:
    properties:
      email:
        example: joao@example.com
        type: string
      name:
        example: João Silva
        minLength: 2
        type: string
      password:
        example: senha123
        minLength: 6
        type: string
    required:
    - email
    - name
    - password
    type: object
  handler.ScanQRCodeConfirmRequest:
    properties:
      accessKey:
        description: Chave de acesso
        type: string
      date:
        description: Data da compra (opcional, usa data atual se vazio)
        type: string
      discount:
        description: Desconto
        type: number
      items:
        description: Itens (editados) - utiliza a estrutura PreviewItem
        items:
          $ref: '#/definitions/handler.PreviewItem'
        type: array
      itemsCount:
        description: Total de itens
        type: integer
      number:
        description: Número da nota
        type: string
      qrCodeUrl:
        description: URL original do QR code
        type: string
      storeName:
        description: Nome do estabelecimento
        type: string
      subtotal:
        description: Subtotal
        type: number
      total:
        description: Total (opcional, calcula se zero)
        type: number
    required:
    - items
    - qrCodeUrl
    - storeName
    type: object
  handler.ScanQRCodeConfirmResponse:
    properties:
      message:
        type: string
    type: object
  handler.ScanQRCodePreviewRequest:
    properties:
      qrCodeUrl:
        description: URL do QR Code da NFC-e
        type: string
    required:
    - qrCodeUrl
    type: object
  handler.ScanQRCodePreviewResponse:
    properties:
      data:
        $ref: '#/definitions/handler.PreviewReceiptData'
      message:
        type: string
    type: object
  handler.UpdateCategoryRequest:
    properties:
      color:
        example: '#e74c3c'
        type: string
      description:
        example: Restaurantes e delivery
        type: string
      icon:
        example: "\U0001F355"
        type: string
      name:
        example: Alimentação Fora
        type: string
    type: object
  handler.UpdateItemRequest:
    properties:
      categoryId:
        type: integer
      productId:
        type: integer
      quantity:
        type: number
      total:
        type: number
      unitPrice:
        type: number
    type: object
  handler.UpdateProductRequest:
    properties:
      name:
        type: string
      unity:
        type: string
    type: object
  handler.UpdateReceiptRequest:
    properties:
      date:
        type: string
      discount:
        type: number
      storeName:
        type: string
      subtotal:
        type: number
      total:
        type: number
    type: object
  schemas.AITokenUsageResponse:
    properties:
      costCents:
        type: number
      createdAt:
        type: string
      endpoint:
        type: string
      id:
        type: integer
      model:
        type: string
      promptTokens:
        type: integer
      responseTokens:
        type: integer
      totalTokens:
        type: integer
      usedAt:
        type: string
      userId:
        type: integer
    type: object
  schemas.AITokenUsageSummary:
    properties:
      requestCount:
        type: integer
      totalCostCents:
        type: number
      totalPromptTokens:
        type: integer
      totalResponseTokens:
        type: integer
      totalTokens:
        type: integer
      userId:
        type: integer
    type: object
  schemas.CategorySimple:
    properties:
      id:
        type: integer
      name:
        type: string
    type: object
  schemas.ProductResponse:
    properties:
      createdAt:
        type: string
      id:
        type: integer
      name:
        type: string
      unity:
        type: string
      updatedAt:
        type: string
    type: object
  schemas.ProductSimple:
    properties:
      id:
        type: integer
      name:
        type: string
      unity:
        type: string
    type: object
  schemas.ReceiptBasic:
    properties:
      currency:
        type: string
      date:
        type: string
      id:
        type: integer
      itemCount:
        description: Número de itens
        type: integer
      storeName:
        type: string
      total:
        type: number
    type: object
  schemas.ReceiptItemResponse:
    properties:
      category:
        allOf:
        - $ref: '#/definitions/schemas.CategorySimple'
        description: Apenas ID e Nome
      categoryId:
        type: integer
      createdAt:
        type: string
      id:
        type: integer
      product:
        allOf:
        - $ref: '#/definitions/schemas.ProductSimple'
        description: Nome e unidade do produto
      productId:
        type: integer
      quantity:
        type: number
      receiptId:
        type: integer
      total:
        type: number
      unitPrice:
        type: number
      updatedAt:
        type: string
    type: object
  schemas.ReceiptItemSummary:
    properties:
      category:
        allOf:
        - $ref: '#/definitions/schemas.CategorySimple'
        description: Apenas ID e Nome
      categoryId:
        type: integer
      id:
        type: integer
      product:
        allOf:
        - $ref: '#/definitions/schemas.ProductSimple'
        description: Nome e unidade do produto
      productId:
        type: integer
      quantity:
        type: number
      total:
        type: number
      unitPrice:
        type: number
    type: object
  schemas.ReceiptSummary:
    properties:
      currency:
        type: string
      date:
        type: string
      id:
        type: integer
      items:
        items:
          $ref: '#/definitions/schemas.ReceiptItemSummary'
        type: array
      storeName:
        type: string
      total:
        type: number
    type: object
  schemas.UserResponse:
    properties:
      createdAt:
        type: string
      email:
        type: string
      id:
        type: integer
      name:
        type: string
      updatedAt:
        type: string
    type: object
host: 147.185.221.212:61489
info:
  contact:
    email: suporte@exemplo.com
    name: Equipe de Desenvolvimento
    url: https://github.com/Pmmvito/Golang-Api-Exemple
  description: "API REST para autenticação JWT, análise inteligente de notas fiscais
    de supermercado e gestão de categorias\n\n## \U0001F680 Funcionalidades Principais:\n-
    \U0001F510 **Autenticação JWT** com tokens de 7 dias\n- \U0001F916 **Análise de
    Notas com IA** usando Google Gemini (2-3s)\n- \U0001F4CA **Categorização Automática**
    de produtos de supermercado\n- \U0001F4DD **CRUD Completo** de recibos e categorias\n-
    \U0001F50D **Filtros Avançados** por categoria, data e valor\n- ⚡ **Respostas
    Otimizadas** (55% menores)\n\n## \U0001F4D6 Como Usar:\n1. Registre-se em `/register`\n2.
    Faça login em `/login` para obter o token JWT\n3. Clique em **Authorize** \U0001F513
    (cadeado verde) e cole: `Bearer SEU_TOKEN`\n4. Agora você pode testar todos os
    endpoints protegidos!\n\n## \U0001F6D2 Categorias de Supermercado (21 categorias
    distintas):\n**Básicos:** Grãos e Cereais, Massas, Padaria\n**Proteínas:** Carnes
    e Proteínas, Frios e Embutidos\n**Laticínios:** Leite, Queijos, Iogurtes, Manteiga\n**Frescos:**
    Frutas e Vegetais\n**Bebidas:** Bebidas (não alcoólicas), Bebidas Alcoólicas,
    Café e Chá\n**Congelados:** Produtos Congelados\n**Doces:** Doces e Sobremesas,
    Salgadinhos e Snacks\n**Despensa:** Condimentos e Temperos, Enlatados e Conservas\n**Casa:**
    Higiene Pessoal, Limpeza Doméstica, Papel e Descartáveis\n**Especiais:** Bebê
    e Infantil, Pet Shop, Outros\n\nUse `/categories` para ver todas as categorias
    com IDs!"
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: http://swagger.io/terms/
  title: API de Gestão de Notas Fiscais com IA
  version: "2.0"
paths:
  /ai-usage:
    get:
      description: Retorna todo o histórico de uso de tokens da IA do usuário autenticado
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.AITokenUsageResponse'
            type: array
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Obter histórico de uso de tokens
      tags:
      - ai-usage
  /ai-usage/summary:
    get:
      description: Retorna estatísticas consolidadas de uso de tokens da IA do usuário
        autenticado
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.AITokenUsageSummary'
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Obter resumo de uso de tokens
      tags:
      - ai-usage
  /categories:
    get:
      consumes:
      - application/json
      description: 'Get all expense categories sorted by name. Returns: 1-Alimentação,
        2-Transporte, 3-Saúde, 4-Lazer, 5-Educação, 6-Moradia, 7-Vestuário, 8-Outros'
      produces:
      - application/json
      responses:
        "200":
          description: List of categories with count
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao buscar categorias no banco de dados. Por favor, tente
            novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List all categories
      tags:
      - "\U0001F4C1 Categories"
  /categories/graph:
    get:
      consumes:
      - application/json
      description: Get aggregated data for each category, including item count and
        total value. Filters by date range, defaulting to the current month.
      parameters:
      - description: Start date for filtering (YYYY-MM-DD)
        in: query
        name: start_date
        type: string
      - description: End date for filtering (YYYY-MM-DD)
        in: query
        name: end_date
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Category graph data retrieved successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: 'Formato de start_date inválido. Use o formato YYYY-MM-DD (exemplo:
            2024-01-15) | Formato de end_date inválido. Use o formato YYYY-MM-DD (exemplo:
            2024-01-31)'
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao buscar notas fiscais do período. Por favor, tente novamente
            | Erro ao buscar itens das notas fiscais. Por favor, tente novamente |
            Erro ao buscar categorias. Por favor, tente novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get category graph data
      tags:
      - "\U0001F4C1 Categories"
  /category:
    post:
      consumes:
      - application/json
      description: Create a new expense category for organizing receipt items. If
        a category with the same name was previously deleted, it will be reactivated.
      parameters:
      - description: Category data (name is required, description/icon/color are optional)
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.CreateCategoryRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Category reactivated successfully (when reactivating a deleted
            category)
          schema:
            additionalProperties: true
            type: object
        "201":
          description: Category created successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Dados inválidos para criação de categoria. O campo 'name' é
            obrigatório
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "409":
          description: Já existe uma categoria ativa com este nome. Por favor, escolha
            outro nome ou utilize a categoria existente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao reativar a categoria deletada anteriormente. Por favor,
            tente novamente | Erro ao criar categoria no banco de dados. Por favor,
            tente novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create new category
      tags:
      - "\U0001F4C1 Categories"
  /category/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a category and move all its items to "Não categorizado".
        Items can be recategorized later using the /items/recategorize endpoint.
      parameters:
      - description: Category ID
        example: 1
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Category deleted successfully, items moved to 'Não categorizado'
          schema:
            additionalProperties: true
            type: object
        "400":
          description: ID da categoria é obrigatório na URL | A categoria 'Não categorizado'
            é do sistema e não pode ser deletada
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Categoria não encontrada. Verifique se o ID está correto e
            se a categoria não foi deletada anteriormente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Categoria do sistema 'Não categorizado' não foi encontrada.
            Por favor, restaure as categorias padrão | Erro ao mover itens para a
            categoria 'Não categorizado'. Operação cancelada | Erro ao deletar categoria.
            Operação cancelada | Erro ao confirmar a exclusão da categoria no banco
            de dados. Por favor, tente novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete category
      tags:
      - "\U0001F4C1 Categories"
    get:
      consumes:
      - application/json
      description: Get details of a specific category by ID including all items that
        belong to this category
      parameters:
      - description: Category ID
        example: 1
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Category details with items
          schema:
            additionalProperties: true
            type: object
        "400":
          description: ID da categoria é obrigatório na URL
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Categoria não encontrada. Verifique se o ID está correto e
            se a categoria não foi deletada
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao buscar itens da categoria. Por favor, tente novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get category details
      tags:
      - "\U0001F4C1 Categories"
    patch:
      consumes:
      - application/json
      description: Update category information (name, description, icon, color). All
        fields are optional - only send what you want to update.
      parameters:
      - description: Category ID
        example: 1
        in: path
        name: id
        required: true
        type: integer
      - description: Category data to update (all fields optional)
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateCategoryRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Category updated successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: ID da categoria é obrigatório na URL | Dados inválidos para
            atualização da categoria. Verifique os campos enviados | Nenhum campo
            foi fornecido para atualização. Envie pelo menos um campo (name, description,
            icon ou color)
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Categoria não encontrada. Verifique se o ID está correto e
            se a categoria não foi deletada
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao salvar atualização da categoria no banco de dados.
            Por favor, tente novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update category
      tags:
      - "\U0001F4C1 Categories"
  /item/{id}:
    delete:
      consumes:
      - application/json
      - application/json
      description: |-
        Delete an existing receipt item by its ID.
        Soft delete a receipt item (sets deleted_at timestamp). Note: The associated product is NOT deleted as it may be referenced by other items.
      parameters:
      - description: Item ID
        in: path
        name: id
        required: true
        type: integer
      - description: Receipt Item ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: Item deleted successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Item not found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      - BearerAuth: []
      summary: Delete receipt item
      tags:
      - items
      - items
    get:
      description: Busca um item pelo ID
      parameters:
      - description: ID do item
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.ReceiptItemResponse'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Buscar item por ID
      tags:
      - items
    patch:
      consumes:
      - application/json
      description: Update an existing receipt item. All fields are optional.
      parameters:
      - description: Item ID
        in: path
        name: id
        required: true
        type: integer
      - description: Item data to update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateItemRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.ReceiptItemResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update an item
      tags:
      - items
  /items:
    get:
      description: Lista todos os itens de recibos do usuário autenticado
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptItemResponse'
            type: array
      security:
      - BearerAuth: []
      summary: Listar todos os itens
      tags:
      - items
  /items/date/{date}:
    get:
      description: Lista itens de recibos do usuário autenticado por data de recibo
      parameters:
      - description: Data (YYYY-MM-DD)
        in: path
        name: date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptItemResponse'
            type: array
      security:
      - BearerAuth: []
      summary: Listar itens por data de recibo
      tags:
      - items
  /items/period:
    get:
      description: Lista itens de recibos do usuário autenticado entre query params
        `start` e `end` (RFC3339 ou YYYY-MM-DD). Ambos obrigatórios.
      parameters:
      - description: Data/hora inicial (RFC3339 ou YYYY-MM-DD)
        in: query
        name: start
        required: true
        type: string
      - description: Data/hora final (RFC3339 ou YYYY-MM-DD)
        in: query
        name: end
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptItemResponse'
            type: array
      security:
      - BearerAuth: []
      summary: Listar itens por período
      tags:
      - items
  /items/recategorize:
    post:
      consumes:
      - application/json
      description: Use Gemini AI to recategorize items. Useful for items in "Não categorizado"
        or items that need recategorization.
      parameters:
      - description: Item IDs to recategorize
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.RecategorizeItemsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.RecategorizeItemsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Recategorize items using AI
      tags:
      - items
  /login:
    post:
      consumes:
      - application/json
      description: Authenticate user with email and password. Returns a JWT token
        valid for 7 days. Use this token in the Authorization header as "Bearer {token}"
        for all protected endpoints.
      parameters:
      - description: User credentials (email and password)
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Login successful with JWT token
          schema:
            $ref: '#/definitions/handler.AuthResponse'
        "400":
          description: 'Dados de login inválidos: email e senha são obrigatórios'
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Email ou senha incorretos. Verifique suas credenciais e tente
            novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao gerar token de autenticação. Por favor, tente novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Login
      tags:
      - "\U0001F510 Authentication"
  /logout:
    post:
      description: Invalida o token JWT atual, impedindo seu uso futuro
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Token não encontrado no contexto de autenticação
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Erro ao adicionar o token à lista de tokens invalidados. Por
            favor, tente novamente
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Fazer logout
      tags:
      - auth
  /me:
    get:
      consumes:
      - application/json
      description: Get information about the authenticated user (requires JWT token)
      produces:
      - application/json
      responses:
        "200":
          description: User information retrieved successfully
          schema:
            $ref: '#/definitions/schemas.UserResponse'
        "401":
          description: Usuário não encontrado no contexto de autenticação. Token pode
            estar inválido ou expirado
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current user profile
      tags:
      - "\U0001F510 Authentication"
  /product/{id}:
    delete:
      consumes:
      - application/json
      - application/json
      description: |-
        Delete an existing product by its ID.
        Soft delete a product and ALL its associated receipt items across all user's receipts (sets deleted_at timestamp). Warning: This will delete ALL occurrences of this product in ALL your receipts.
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: Product deleted successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Product not found or not owned by user
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      - BearerAuth: []
      summary: Delete product
      tags:
      - products
      - products
  /products:
    get:
      description: |-
        Lista todos os produtos cadastrados
        Lista todos os produtos que o usuário possui em suas notas fiscais ativas
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ProductResponse'
            type: array
      security:
      - BearerAuth: []
      - BearerAuth: []
      summary: Listar todos os produtos
      tags:
      - products
      - products
  /products/{id}:
    delete:
      consumes:
      - application/json
      - application/json
      description: |-
        Delete an existing product by its ID.
        Soft delete a product and ALL its associated receipt items across all user's receipts (sets deleted_at timestamp). Warning: This will delete ALL occurrences of this product in ALL your receipts.
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: Product deleted successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Product not found or not owned by user
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      - BearerAuth: []
      summary: Delete product
      tags:
      - products
      - products
    get:
      description: Busca produto pelo ID (apenas se o usuário tiver este produto em
        alguma nota ativa)
      parameters:
      - description: ID do produto
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.ProductResponse'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Buscar produto por ID
      tags:
      - products
    patch:
      consumes:
      - application/json
      description: Update an existing product. All fields are optional.
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      - description: Product data to update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateProductRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.ProductResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update a product
      tags:
      - products
  /products/date/{date}:
    get:
      description: Retorna todos os produtos comprados em uma data específica (YYYY-MM-DD)
        através de notas fiscais
      parameters:
      - description: Data no formato YYYY-MM-DD
        in: path
        name: date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ProductResponse'
            type: array
      security:
      - BearerAuth: []
      summary: Buscar produtos por data
      tags:
      - products
  /products/period:
    get:
      description: Retorna todos os produtos comprados entre as query params `start`
        e `end` (YYYY-MM-DD). Ambos são obrigatórios.
      parameters:
      - description: Data inicial (YYYY-MM-DD)
        in: query
        name: start
        required: true
        type: string
      - description: Data final (YYYY-MM-DD)
        in: query
        name: end
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ProductResponse'
            type: array
      security:
      - BearerAuth: []
      summary: Buscar produtos por período
      tags:
      - products
  /receipt/{id}:
    delete:
      consumes:
      - application/json
      - application/json
      description: |-
        Delete an existing receipt by its ID.
        Soft delete a receipt and all its related items and products (sets deleted_at timestamp)
      parameters:
      - description: Receipt ID
        in: path
        name: id
        required: true
        type: integer
      - description: Receipt ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: Receipt deleted successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized - Invalid or missing token
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Receipt not found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      - BearerAuth: []
      summary: Delete a receipt
      tags:
      - notasfiscais
      - notasfiscais
    get:
      description: Busca um recibo pelo ID do usuário autenticado
      parameters:
      - description: ID do recibo
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.ReceiptSummary'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Buscar recibo por ID
      tags:
      - notasfiscais
    patch:
      consumes:
      - application/json
      description: Update an existing receipt. All fields are optional.
      parameters:
      - description: Receipt ID
        in: path
        name: id
        required: true
        type: integer
      - description: Receipt data to update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateReceiptRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.ReceiptSummary'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update a receipt
      tags:
      - notasfiscais
  /receipts:
    get:
      description: Lista todos os recibos do usuário autenticado
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptSummary'
            type: array
      security:
      - BearerAuth: []
      summary: Listar todos os recibos
      tags:
      - notasfiscais
  /receipts-basic:
    get:
      description: Lista todos os recibos do usuário autenticado (versão ultra-simplificada
        para seleção)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptBasic'
            type: array
      security:
      - BearerAuth: []
      summary: Listar recibos básicos
      tags:
      - notasfiscais-basic
  /receipts-basic/date/{date}:
    get:
      description: Lista recibos básicos do usuário autenticado por data específica
        (YYYY-MM-DD)
      parameters:
      - description: Data (YYYY-MM-DD)
        in: path
        name: date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptBasic'
            type: array
      security:
      - BearerAuth: []
      summary: Listar recibos básicos por data específica
      tags:
      - notasfiscais-basic
  /receipts-basic/period:
    get:
      description: Lista recibos básicos do usuário autenticado por período de datas
      parameters:
      - description: Data inicial (YYYY-MM-DD)
        in: query
        name: start_date
        required: true
        type: string
      - description: Data final (YYYY-MM-DD)
        in: query
        name: end_date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptBasic'
            type: array
      security:
      - BearerAuth: []
      summary: Listar recibos básicos por período
      tags:
      - notasfiscais-basic
  /receipts/date/{date}:
    get:
      description: Lista recibos do usuário autenticado por data específica (YYYY-MM-DD)
      parameters:
      - description: Data (YYYY-MM-DD)
        in: path
        name: date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptSummary'
            type: array
      security:
      - BearerAuth: []
      summary: Buscar recibos por data específica
      tags:
      - notasfiscais
  /receipts/period:
    get:
      description: Lista recibos do usuário autenticado por período de datas
      parameters:
      - description: Data inicial (YYYY-MM-DD)
        in: query
        name: start_date
        required: true
        type: string
      - description: Data final (YYYY-MM-DD)
        in: query
        name: end_date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/schemas.ReceiptSummary'
            type: array
      security:
      - BearerAuth: []
      summary: Buscar recibos por período
      tags:
      - notasfiscais
  /register:
    post:
      consumes:
      - application/json
      description: Create a new user account. After registration, use the login endpoint
        to get your JWT token.
      parameters:
      - description: User registration data (name, email, password)
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: User created successfully with JWT token
          schema:
            $ref: '#/definitions/handler.AuthResponse'
        "400":
          description: 'Dados de registro inválidos: verifique se nome (mínimo 2 caracteres),
            email válido e senha (mínimo 6 caracteres) foram fornecidos corretamente
            | Este email já está cadastrado. Por favor, utilize outro email ou faça
            login | Este email foi utilizado em uma conta deletada e não pode ser
            reutilizado por questões de segurança'
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao processar a senha durante o cadastro. Por favor, tente
            novamente | Erro ao criar usuário no banco de dados. Por favor, tente
            novamente mais tarde | Usuário criado com sucesso, mas houve erro ao gerar
            o token de autenticação. Por favor, faça login
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Register new user
      tags:
      - "\U0001F510 Authentication"
  /scan-qrcode/confirm:
    post:
      consumes:
      - application/json
      description: Categoriza items com IA e salva nota fiscal no banco de dados.
        Envie APENAS o campo 'data' da resposta do preview, NÃO envie 'message'.
      parameters:
      - description: Dados da nota (envie APENAS o campo 'data' do preview, sem 'message')
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.ScanQRCodeConfirmRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.ScanQRCodeConfirmResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Confirmar e salvar NFC-e (Etapa 2/2)
      tags:
      - receipts
  /scan-qrcode/preview:
    post:
      consumes:
      - application/json
      description: Extrai dados da NFC-e sem salvar no banco. Retorna dados para visualização/edição
      parameters:
      - description: QR Code URL
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.ScanQRCodePreviewRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.ScanQRCodePreviewResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Preview de NFC-e via QR Code (Etapa 1/2)
      tags:
      - receipts
  /user:
    delete:
      consumes:
      - application/json
      description: Soft delete user account and all associated data (receipts, items,
        products, shopping lists, tokens). Email cannot be reused even after deletion.
      produces:
      - application/json
      responses:
        "200":
          description: User deleted successfully
          schema:
            additionalProperties: true
            type: object
        "401":
          description: ID do usuário não encontrado no contexto de autenticação. Por
            favor, faça login novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Usuário não encontrado no banco de dados. Pode ter sido deletado
            anteriormente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Erro ao buscar notas fiscais do usuário durante a exclusão
            | Erro ao deletar itens das notas fiscais. Operação cancelada | Erro ao
            deletar notas fiscais. Operação cancelada | Erro ao buscar listas de compras
            durante a exclusão | Erro ao deletar itens das listas de compras. Operação
            cancelada | Erro ao deletar listas de compras. Operação cancelada | Erro
            ao deletar tokens da blacklist. Operação cancelada | Erro ao deletar registros
            de uso da IA. Operação cancelada | Erro ao deletar usuário. Operação cancelada
            | Erro ao confirmar a exclusão no banco de dados. Por favor, tente novamente
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete user account
      tags:
      - users
securityDefinitions:
  BearerAuth:
    description: 'Digite "Bearer" seguido do seu token JWT (obtido no login). Exemplo:
      Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
